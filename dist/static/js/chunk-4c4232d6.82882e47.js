(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c4232d6"],{4381:function(e,t,a){"use strict";a("d3b7"),a("caad"),a("2532");var n=a("4360");function r(e,t){var a=t.value,r=n["a"].getters&&n["a"].getters.roles;if(!(a&&a instanceof Array))throw new Error("need roles! Like v-permission=\"['admin','editor']\"");if(a.length>0){var o=a,s=r.some((function(e){return o.includes(e)}));s||e.parentNode&&e.parentNode.removeChild(e)}}var o={inserted:function(e,t){r(e,t)},update:function(e,t){r(e,t)}},s=function(e){e.directive("permission",o)};window.Vue&&(window["permission"]=o,Vue.use(s)),o.install=s;t["a"]=o},"5bfe":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticStyle:{"margin-bottom":"20px"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"请输入新图集名称",clearable:""},model:{value:e.newAlbumName,callback:function(t){e.newAlbumName=t},expression:"newAlbumName"}}),a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.addTab(e.editableTabsValue)}}},[e._v(" 新建图集 ")])],1),a("el-tabs",{attrs:{type:"card",closable:""},on:{"tab-remove":e.removeTab},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},e._l(e.editableTabs,(function(t,n){return a("el-tab-pane",{key:t.name,attrs:{label:t.name,name:t.name}},[a("el-row",e._l(e.photoList,(function(t,n){return a("el-col",{key:n,attrs:{span:6,offset:0}},[a("el-card",{attrs:{"body-style":{padding:"5px"}}},[a("img",{staticClass:"pic_image",attrs:{src:t.url}}),a("div",{staticStyle:{padding:"5px"}},[a("span",[e._v(e._s(t.photo_name))]),a("div",{staticClass:"pic_bottom pic_clearfix"},[a("br"),a("el-button",{staticClass:"pic_button",attrs:{type:"text"}},[e._v("修改名称")]),a("el-button",{staticClass:"pic_button",attrs:{type:"text"}},[e._v("设为主页图")])],1)])])],1)})),1),a("br"),a("el-divider"),a("el-upload",{directives:[{name:"permission",rawName:"v-permission",value:["admin"],expression:"['admin']"}],staticClass:"upload-demo",attrs:{headers:e.headers,action:e.uploadUrl,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,"on-success":e.handleSuccess,"on-error":e.handleError,"file-list":e.uploadPhotoList,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg文件")])],1)],1)})),1)],1)},r=[],o=a("7580"),s=(a("b0c0"),a("96cf"),a("5f87")),i=a("b775");function l(e){return Object(i["a"])({url:"http://localhost:8080/photo_list",method:"post",params:{name:e}})}function u(){return Object(i["a"])({url:"http://localhost:8080/album_list",method:"post"})}function c(e){return Object(i["a"])({url:"http://localhost:8080/create_album",method:"post",params:{name:e}})}function d(e){return Object(i["a"])({url:"http://localhost:8080/remove_album",method:"post",params:{name:e}})}var p=a("4381"),b={directives:{permission:p["a"]},data:function(){return{uploadUrl:"",newAlbumName:"",editableTabsValue:"",editableTabs:[],photoList:[],uploadPhotoList:[],headers:{}}},watch:{editableTabsValue:function(e){"0"!=e&&(this.getPhotoInfo(e),this.uploadUrl="http://localhost:8080/upload/photo/"+e)}},mounted:function(){this.headers["X-token"]=Object(s["a"])(),console.log("this.editableTabsValue",this.editableTabsValue),this.getTabInfo()},methods:{getPhotoInfo:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l(e.editableTabsValue);case 2:a=t.sent,n=a.data,e.photoList=n,console.log("获取到的图片",n);case 6:case"end":return t.stop()}}),t)})))()},getTabInfo:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u();case 2:a=t.sent,n=a.data,e.editableTabs=n,e.editableTabsValue=e.editableTabs[0].name,console.log("获取到的图库：",n);case 7:case"end":return t.stop()}}),t)})))()},handleRemove:function(e,t){this.uploadPhotoList=t,console.log("Upload file lists: ",this.uploadPhotoList)},handlePreview:function(e){this.$alert("暂时无此功能！"),console.log(e)},beforeRemove:function(e,t){return this.$confirm("确定移除".concat(e.name,"？"))},handleSuccess:function(e,t,a){this.getPhotoInfo()},handleError:function(e,t,a){this.$alert("上传失败，请重试！")},addTab:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.newAlbumName,!(a.length<2)){e.next=5;break}return e.next=4,t.$alert("相册名称长度过短！");case 4:return e.abrupt("return");case 5:return e.next=7,c(a);case 7:if(n=e.sent,r=n.data,"success"!==r){e.next=16;break}return e.next=12,t.getTabInfo();case 12:return t.editableTabsValue=a,e.abrupt("return");case 16:return e.next=18,t.$alert("插入新相册失败！请重试！错误信息：",r);case 18:return e.abrupt("return");case 19:case"end":return e.stop()}}),e)})))()},removeTab:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$confirm("确定要删除这个相册吗？该删除操作不可逆！");case 2:return console.log("targetName: ",e),a.next=5,d(e);case 5:if(n=a.sent,r=n.data,"success"!==r){a.next=13;break}return a.next=10,t.getTabInfo();case 10:return a.abrupt("return");case 13:return a.next=15,t.$alert("删除相册失败！请重试！错误信息：",r);case 15:return a.abrupt("return");case 16:case"end":return a.stop()}}),a)})))()}}},m=b,h=a("2877"),f=Object(h["a"])(m,n,r,!1,null,null,null);t["default"]=f.exports}}]);